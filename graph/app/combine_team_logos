import pandas as pd
import glob
import os

# Find all team_logo CSVs in the current directory (adjust pattern if needed)
csv_files = glob.glob("team_logos*.csv")

print(f"Found {len(csv_files)} logo files:", csv_files)

# Read and concatenate all of them
dfs = []
for file in csv_files:
    df = pd.read_csv(file)
    dfs.append(df)

combined_df = pd.concat(dfs, ignore_index=True)

# Drop duplicates just in case (same team might appear multiple times)
combined_df.drop_duplicates(subset=["team_name"], inplace=True)

# Sort alphabetically by team name for clarity
combined_df.sort_values(by="team_name", inplace=True)

# Save combined file
output_path = os.path.join(os.getcwd(), "team_logos_combined.csv")
combined_df.to_csv(output_path, index=False)

print(f"âœ… Combined team logos saved to {output_path}")
print(f"Total unique teams: {len(combined_df)}")